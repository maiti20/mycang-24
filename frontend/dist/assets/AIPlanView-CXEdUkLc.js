import{d as j,r as g,j as B,k as E,a as n,h as p,b as s,e as r,m as H,w as v,i as f,v as z,f as m,t as a,F as x,g as h,q as O,n as T,x as C,y as J,o as d,_ as K}from"./index-CQKIO0cK.js";const Q={class:"ai-plan-view container py-4"},W={class:"row mb-4"},X={class:"col-12"},Y={class:"card border-0 shadow-sm"},Z={class:"card-body"},ss={class:"row g-3"},ts={class:"col-md-6"},es={class:"col-md-6"},os={class:"col-md-6"},ls={class:"col-md-6"},is={class:"col-md-6"},as={class:"col-md-6"},ns={class:"col-12"},ds={class:"col-12"},rs={class:"d-flex justify-content-end gap-2"},cs=["disabled"],bs={key:0,class:"spinner-border spinner-border-sm me-1"},us={class:"row"},vs={class:"col-12"},ms={class:"card border-0 shadow-sm"},ps={class:"card-header bg-white border-bottom"},fs={class:"d-flex justify-content-between align-items-center"},ys={class:"badge bg-primary rounded-pill"},_s={class:"card-body p-0"},gs={key:0,class:"text-center py-5"},ws={key:1,class:"p-3"},xs={class:"row g-3"},hs={class:"card h-100 border-0 shadow-sm hover-lift"},ks={class:"card-header bg-gradient-light border-bottom"},Is={class:"d-flex justify-content-between align-items-start"},Cs={class:"card-title mb-1 fw-semibold"},qs={class:"text-muted"},As={class:"card-body"},Ps={class:"mb-3"},Vs={class:"d-flex align-items-center mb-2"},Ts={class:"ms-1 fw-medium"},Ds={class:"d-flex align-items-center mb-2"},$s={class:"ms-1 fw-medium"},Ls={class:"d-flex align-items-center mb-2"},Ss={class:"ms-1 fw-medium"},Ms={class:"d-flex align-items-center"},Fs={class:"ms-1 fw-medium"},Us={class:"plan-preview"},Gs={class:"card-text text-muted small mb-0"},Rs={class:"card-footer bg-white border-top"},Ns={class:"btn-group w-100",role:"group"},js=["onClick"],Bs=["onClick"],Es=["onClick"],Hs={key:2,class:"text-center py-5"},zs={class:"modal-dialog modal-xl modal-dialog-centered"},Os={class:"modal-content"},Js={class:"modal-header"},Ks={class:"modal-title"},Qs={class:"modal-body"},Ws={key:0,class:"ai-plan-detail"},Xs={class:"row mb-4"},Ys={class:"col-md-3"},Zs={class:"card border-0 bg-light"},st={class:"card-body text-center"},tt={class:"card-text fw-semibold"},et={class:"col-md-3"},ot={class:"card border-0 bg-light"},lt={class:"card-body text-center"},it={class:"card-text fw-semibold"},at={class:"col-md-3"},nt={class:"card border-0 bg-light"},dt={class:"card-body text-center"},rt={class:"card-text fw-semibold"},ct={class:"col-md-3"},bt={class:"card border-0 bg-light"},ut={class:"card-body text-center"},vt={class:"card-text fw-semibold"},mt={class:"card border-0 mb-3"},pt={class:"card-body"},ft={key:0,class:"row g-3"},yt={class:"card h-100 border-primary border-opacity-25"},_t={class:"card-header bg-primary bg-opacity-10 py-2"},gt={class:"badge bg-primary float-end"},wt={class:"card-body py-2"},xt={class:"small"},ht={class:"mb-1"},kt={class:"mb-1 ps-3"},It={key:0,class:"mb-0 text-muted"},Ct=["innerHTML"],qt={key:0,class:"card border-0 mb-3"},At={class:"card-body"},Pt=["innerHTML"],Vt={key:1,class:"card border-0"},Tt={class:"card-body"},Dt={class:"mb-0"},$t={class:"modal-footer"},Lt=j({__name:"AIPlanView",setup(St){const D=J(),k=g(!1),y=g(!1),b=g([]),_=g(!1),i=g(null),l=B({fitnessGoal:"",experienceLevel:"",weeklyFrequency:"",sessionDuration:"",preferredTypes:"",healthCondition:"良好",specialRequirements:""}),$=async()=>{k.value=!0;try{const o=await C.getPlans();o.success&&o.data?b.value=o.data.plans||[]:b.value=[]}catch(o){console.error("获取AI方案失败:",o),b.value=[]}finally{k.value=!1}},L=async()=>{y.value=!0;try{const o={fitness_goal:l.fitnessGoal,experience_level:l.experienceLevel,weekly_frequency:l.weeklyFrequency,session_duration:l.sessionDuration,preferred_types:l.preferredTypes||void 0,health_condition:l.healthCondition,special_requirements:l.specialRequirements||void 0},t=await C.generatePlan(o);if(t.success&&t.data){const c={id:t.data.id,title:t.data.title,description:t.data.description,weekly_schedule:t.data.weekly_schedule,nutrition_advice:t.data.nutrition_advice,tips:t.data.tips,created_at:t.data.created_at||new Date().toISOString()};b.value.unshift(c),i.value=c,_.value=!0,q()}else throw new Error(t.message||"生成失败")}catch(o){console.error("生成AI方案失败:",o),alert("生成AI方案失败，请稍后重试。错误信息："+o.message)}finally{y.value=!1}},q=()=>{l.fitnessGoal="",l.experienceLevel="",l.weeklyFrequency="",l.sessionDuration="",l.preferredTypes="",l.healthCondition="良好",l.specialRequirements=""},S=o=>{i.value=o,_.value=!0},I=()=>{_.value=!1,i.value=null},A=o=>{D.push({name:"ExerciseLog",query:{planId:o.id.toString()}})},P=async o=>{var t;if(confirm("确定要删除这个AI健身方案吗？删除后无法恢复。"))try{const c=await C.deletePlan(o);if(c.success)b.value=b.value.filter(w=>w.id!==o),((t=i.value)==null?void 0:t.id)===o&&I();else throw new Error(c.message||"删除失败")}catch(c){console.error("删除AI方案失败:",c),alert("删除AI方案失败: "+c.message)}},M=()=>{const o=document.querySelector(".card-header");o==null||o.scrollIntoView({behavior:"smooth"})},F=o=>{switch(o){case"已生成":return"bg-success";case"生成中":return"bg-warning";case"进行中":return"bg-primary";default:return"bg-secondary"}},U=o=>new Date(o).toLocaleDateString("zh-CN"),G=(o,t)=>o.length<=t?o:o.substring(0,t)+"...",V=o=>o?o.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,'<h6 class="mt-3 mb-2 fw-bold">$1</h6>').replace(/##\s*(.*?)(<br>|$)/g,'<h5 class="mt-3 mb-2 fw-bold text-primary">$1</h5>').replace(/-\s*(.*?)(<br>|$)/g,'<li class="ms-3">$1</li>'):"";return E(()=>{$()}),(o,t)=>{var c,w;return d(),n("div",Q,[t[59]||(t[59]=p('<div class="row mb-4" data-v-0b493026><div class="col-12" data-v-0b493026><div class="card border-0 bg-gradient-ai text-white" data-v-0b493026><div class="card-body" data-v-0b493026><h1 class="mb-2" data-v-0b493026><i class="bi bi-robot me-2" data-v-0b493026></i> AI健身方案 </h1><p class="mb-0 opacity-75" data-v-0b493026>基于您的个人数据和健身目标，AI为您量身定制专属健身方案</p></div></div></div></div>',1)),s("div",W,[s("div",X,[s("div",Y,[t[24]||(t[24]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0 fw-semibold"},[s("i",{class:"bi bi-magic me-2"}),r(" 生成新的AI健身方案 ")])],-1)),s("div",Z,[s("form",{onSubmit:H(L,["prevent"])},[s("div",ss,[s("div",ts,[t[10]||(t[10]=s("label",{class:"form-label fw-semibold"},"健身目标",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[0]||(t[0]=e=>l.fitnessGoal=e),required:""},[...t[9]||(t[9]=[p('<option value="" data-v-0b493026>请选择健身目标</option><option value="减脂塑形" data-v-0b493026>减脂塑形</option><option value="增肌强体" data-v-0b493026>增肌强体</option><option value="提升耐力" data-v-0b493026>提升耐力</option><option value="增强柔韧性" data-v-0b493026>增强柔韧性</option><option value="综合健康" data-v-0b493026>综合健康</option>',6)])],512),[[f,l.fitnessGoal]])]),s("div",es,[t[12]||(t[12]=s("label",{class:"form-label fw-semibold"},"运动经验",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[1]||(t[1]=e=>l.experienceLevel=e),required:""},[...t[11]||(t[11]=[s("option",{value:""},"请选择运动经验",-1),s("option",{value:"初学者"},"初学者",-1),s("option",{value:"中级"},"中级",-1),s("option",{value:"高级"},"高级",-1)])],512),[[f,l.experienceLevel]])]),s("div",os,[t[14]||(t[14]=s("label",{class:"form-label fw-semibold"},"每周运动天数",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=e=>l.weeklyFrequency=e),required:""},[...t[13]||(t[13]=[p('<option value="" data-v-0b493026>请选择频率</option><option value="2-3天" data-v-0b493026>2-3天</option><option value="3-4天" data-v-0b493026>3-4天</option><option value="4-5天" data-v-0b493026>4-5天</option><option value="5-6天" data-v-0b493026>5-6天</option><option value="每天" data-v-0b493026>每天</option>',6)])],512),[[f,l.weeklyFrequency]])]),s("div",ls,[t[16]||(t[16]=s("label",{class:"form-label fw-semibold"},"每次运动时长",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>l.sessionDuration=e),required:""},[...t[15]||(t[15]=[p('<option value="" data-v-0b493026>请选择时长</option><option value="30分钟以内" data-v-0b493026>30分钟以内</option><option value="30-60分钟" data-v-0b493026>30-60分钟</option><option value="60-90分钟" data-v-0b493026>60-90分钟</option><option value="90分钟以上" data-v-0b493026>90分钟以上</option>',5)])],512),[[f,l.sessionDuration]])]),s("div",is,[t[18]||(t[18]=s("label",{class:"form-label fw-semibold"},"偏好运动类型",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[4]||(t[4]=e=>l.preferredTypes=e)},[...t[17]||(t[17]=[p('<option value="" data-v-0b493026>无特殊偏好</option><option value="有氧运动为主" data-v-0b493026>有氧运动为主</option><option value="力量训练为主" data-v-0b493026>力量训练为主</option><option value="混合训练" data-v-0b493026>混合训练</option><option value="瑜伽普拉提" data-v-0b493026>瑜伽普拉提</option>',5)])],512),[[f,l.preferredTypes]])]),s("div",as,[t[20]||(t[20]=s("label",{class:"form-label fw-semibold"},"健康状况",-1)),v(s("select",{class:"form-select","onUpdate:modelValue":t[5]||(t[5]=e=>l.healthCondition=e)},[...t[19]||(t[19]=[p('<option value="良好" data-v-0b493026>良好</option><option value="有关节问题" data-v-0b493026>有关节问题</option><option value="有心血管问题" data-v-0b493026>有心血管问题</option><option value="恢复期" data-v-0b493026>恢复期</option><option value="其他" data-v-0b493026>其他</option>',5)])],512),[[f,l.healthCondition]])]),s("div",ns,[t[21]||(t[21]=s("label",{class:"form-label fw-semibold"},"特殊需求或限制",-1)),v(s("textarea",{class:"form-control",rows:"3","onUpdate:modelValue":t[6]||(t[6]=e=>l.specialRequirements=e),placeholder:"如有特殊的身体状况、运动限制或具体需求，请在此说明..."},null,512),[[z,l.specialRequirements]])]),s("div",ds,[s("div",rs,[s("button",{type:"button",class:"btn btn-outline-secondary",onClick:q},[...t[22]||(t[22]=[s("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),r(" 重置 ",-1)])]),s("button",{type:"submit",class:"btn btn-primary",disabled:y.value},[y.value?(d(),n("span",bs)):m("",!0),t[23]||(t[23]=s("i",{class:"bi bi-stars me-1"},null,-1)),r(" "+a(y.value?"AI正在思考中...":"生成AI方案"),1)],8,cs)])])])],32)])])])]),s("div",us,[s("div",vs,[s("div",ms,[s("div",ps,[s("div",fs,[t[25]||(t[25]=s("h5",{class:"mb-0 fw-semibold"},[s("i",{class:"bi bi-collection me-2"}),r(" 我的AI健身方案 ")],-1)),s("span",ys,a(b.value.length)+" 个方案 ",1)])]),s("div",_s,[k.value?(d(),n("div",gs,[...t[26]||(t[26]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"加载中...")],-1),s("p",{class:"mt-2 text-muted"},"正在加载AI健身方案...",-1)])])):b.value.length>0?(d(),n("div",ws,[s("div",xs,[(d(!0),n(x,null,h(b.value,e=>(d(),n("div",{key:e.id,class:"col-md-6 col-lg-4"},[s("div",hs,[s("div",ks,[s("div",Is,[s("div",null,[s("h6",Cs,a(e.title),1),s("small",qs,a(U(e.created_at)),1)]),s("span",{class:T(["badge",F(e.status)])},a(e.status),3)])]),s("div",As,[s("div",Ps,[s("div",Vs,[t[27]||(t[27]=s("i",{class:"bi bi-target text-primary me-2"},null,-1)),t[28]||(t[28]=s("small",{class:"text-muted"},"目标：",-1)),s("span",Ts,a(e.fitness_goal),1)]),s("div",Ds,[t[29]||(t[29]=s("i",{class:"bi bi-calendar-week text-success me-2"},null,-1)),t[30]||(t[30]=s("small",{class:"text-muted"},"频率：",-1)),s("span",$s,a(e.weekly_frequency),1)]),s("div",Ls,[t[31]||(t[31]=s("i",{class:"bi bi-clock text-warning me-2"},null,-1)),t[32]||(t[32]=s("small",{class:"text-muted"},"时长：",-1)),s("span",Ss,a(e.session_duration),1)]),s("div",Ms,[t[33]||(t[33]=s("i",{class:"bi bi-bar-chart text-info me-2"},null,-1)),t[34]||(t[34]=s("small",{class:"text-muted"},"难度：",-1)),s("span",Fs,a(e.experience_level),1)])]),s("div",Us,[s("p",Gs,a(G(e.description||e.plan_content||"点击查看详情",100)),1)])]),s("div",Rs,[s("div",Ns,[s("button",{class:"btn btn-outline-primary btn-sm",onClick:u=>S(e)},[...t[35]||(t[35]=[s("i",{class:"bi bi-eye me-1"},null,-1),r(" 查看 ",-1)])],8,js),e.status==="已生成"?(d(),n("button",{key:0,class:"btn btn-outline-success btn-sm",onClick:u=>A(e)},[...t[36]||(t[36]=[s("i",{class:"bi bi-play-circle me-1"},null,-1),r(" 开始 ",-1)])],8,Bs)):m("",!0),s("button",{class:"btn btn-outline-danger btn-sm",onClick:u=>P(e.id)},[...t[37]||(t[37]=[s("i",{class:"bi bi-trash me-1"},null,-1),r(" 删除 ",-1)])],8,Es)])])])]))),128))])])):(d(),n("div",Hs,[t[39]||(t[39]=s("div",{class:"text-muted mb-3"},[s("i",{class:"bi bi-robot fs-1"})],-1)),t[40]||(t[40]=s("h5",{class:"text-muted"},"还没有AI健身方案",-1)),t[41]||(t[41]=s("p",{class:"text-muted"},"让AI为您量身定制第一个专属健身方案吧！",-1)),s("button",{class:"btn btn-primary",onClick:M},[...t[38]||(t[38]=[s("i",{class:"bi bi-stars me-2"},null,-1),r(" 生成AI方案 ",-1)])])]))])])])]),s("div",{class:T(["modal fade",{show:_.value}]),style:O({display:_.value?"block":"none"}),tabindex:"-1"},[s("div",zs,[s("div",Os,[s("div",Js,[s("h5",Ks,[t[42]||(t[42]=s("i",{class:"bi bi-robot me-2"},null,-1)),r(" "+a((c=i.value)==null?void 0:c.title),1)]),s("button",{type:"button",class:"btn-close",onClick:I})]),s("div",Qs,[i.value?(d(),n("div",Ws,[s("div",Xs,[s("div",Ys,[s("div",Zs,[s("div",st,[t[43]||(t[43]=s("i",{class:"bi bi-target text-primary fs-3 mb-2"},null,-1)),t[44]||(t[44]=s("h6",{class:"card-title"},"健身目标",-1)),s("p",tt,a(i.value.fitness_goal),1)])])]),s("div",et,[s("div",ot,[s("div",lt,[t[45]||(t[45]=s("i",{class:"bi bi-person-walking text-success fs-3 mb-2"},null,-1)),t[46]||(t[46]=s("h6",{class:"card-title"},"运动经验",-1)),s("p",it,a(i.value.experience_level),1)])])]),s("div",at,[s("div",nt,[s("div",dt,[t[47]||(t[47]=s("i",{class:"bi bi-calendar-week text-warning fs-3 mb-2"},null,-1)),t[48]||(t[48]=s("h6",{class:"card-title"},"运动频率",-1)),s("p",rt,a(i.value.weekly_frequency),1)])])]),s("div",ct,[s("div",bt,[s("div",ut,[t[49]||(t[49]=s("i",{class:"bi bi-clock text-info fs-3 mb-2"},null,-1)),t[50]||(t[50]=s("h6",{class:"card-title"},"运动时长",-1)),s("p",vt,a(i.value.session_duration),1)])])])]),s("div",mt,[t[54]||(t[54]=s("div",{class:"card-header bg-light"},[s("h6",{class:"mb-0 fw-semibold"},[s("i",{class:"bi bi-calendar-week me-2"}),r(" 每周训练安排 ")])],-1)),s("div",pt,[i.value.weekly_schedule?(d(),n("div",ft,[(d(!0),n(x,null,h(i.value.weekly_schedule,(e,u)=>(d(),n("div",{key:u,class:"col-md-6 col-lg-4"},[s("div",yt,[s("div",_t,[s("strong",null,a(u),1),s("span",gt,a(e.type),1)]),s("div",wt,[s("div",xt,[s("p",ht,[t[51]||(t[51]=s("i",{class:"bi bi-clock me-1"},null,-1)),r(a(e.duration)+"分钟 | 强度: "+a(e.intensity),1)]),t[53]||(t[53]=s("p",{class:"mb-1 fw-medium"},"训练内容：",-1)),s("ul",kt,[(d(!0),n(x,null,h(e.activities,(R,N)=>(d(),n("li",{key:N},a(R),1))),128))]),e.notes?(d(),n("p",It,[t[52]||(t[52]=s("i",{class:"bi bi-info-circle me-1"},null,-1)),r(a(e.notes),1)])):m("",!0)])])])]))),128))])):(d(),n("div",{key:1,class:"plan-content",innerHTML:V(i.value.plan_content||i.value.description||"")},null,8,Ct))])]),i.value.nutrition_advice?(d(),n("div",qt,[t[55]||(t[55]=s("div",{class:"card-header bg-success bg-opacity-10"},[s("h6",{class:"mb-0 fw-semibold text-success"},[s("i",{class:"bi bi-egg-fried me-2"}),r(" 营养建议 ")])],-1)),s("div",At,[s("div",{class:"plan-content",innerHTML:V(i.value.nutrition_advice)},null,8,Pt)])])):m("",!0),i.value.tips&&i.value.tips.length?(d(),n("div",Vt,[t[56]||(t[56]=s("div",{class:"card-header bg-warning bg-opacity-10"},[s("h6",{class:"mb-0 fw-semibold text-warning"},[s("i",{class:"bi bi-lightbulb me-2"}),r(" 注意事项 ")])],-1)),s("div",Tt,[s("ul",Dt,[(d(!0),n(x,null,h(i.value.tips,(e,u)=>(d(),n("li",{key:u,class:"mb-1"},a(e),1))),128))])])])):m("",!0)])):m("",!0)]),s("div",$t,[s("button",{type:"button",class:"btn btn-outline-danger me-auto",onClick:t[7]||(t[7]=e=>i.value&&P(i.value.id))},[...t[57]||(t[57]=[s("i",{class:"bi bi-trash me-1"},null,-1),r(" 删除方案 ",-1)])]),s("button",{type:"button",class:"btn btn-secondary",onClick:I}," 关闭 "),((w=i.value)==null?void 0:w.status)==="已生成"?(d(),n("button",{key:0,type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=e=>A(i.value))},[...t[58]||(t[58]=[s("i",{class:"bi bi-play-circle me-1"},null,-1),r(" 开始执行此方案 ",-1)])])):m("",!0)])])])],6)])}}}),Ft=K(Lt,[["__scopeId","data-v-0b493026"]]);export{Ft as default};
