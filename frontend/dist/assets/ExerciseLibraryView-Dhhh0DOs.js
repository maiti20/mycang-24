import{d as O,r as g,c as j,a as n,b as s,e as b,t as d,f as C,n as x,F as _,g as h,h as T,w as M,v as z,i as B,o,_ as G,j as Q,k as ts,l as R,m as ls,p as P,s as W}from"./index-CQKIO0cK.js";import{Q as as}from"./QuickAddExerciseModal-DjFazEQS.js";const is={class:"modal fade show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},os={class:"modal-dialog modal-xl"},ds={class:"modal-content"},ns={class:"modal-header"},cs={class:"modal-title"},rs={class:"modal-body"},us={key:0,class:"row"},bs={class:"col-md-6"},vs={class:"card mb-3"},ms={class:"card-body"},gs={class:"table table-borderless"},ps={class:"badge bg-primary"},ys={class:"badge bg-info text-white"},fs={class:"mt-3"},xs={class:"text-muted"},_s={class:"card mb-3"},hs={class:"card-body"},ks={class:"d-flex flex-wrap gap-2"},$s={key:0,class:"card mb-3"},ws={class:"card-body"},Cs={class:"d-flex flex-wrap gap-2"},Es={class:"col-md-6"},Ms={class:"card mb-3"},Ds={class:"card-body"},Ss={key:0,class:"ratio ratio-16x9"},Vs=["src"],As={key:1,class:"text-center py-4"},Is={class:"card mb-3"},js={class:"card-body"},Bs={class:"mb-3"},Us={class:"d-flex justify-content-between"},qs={class:"mb-3"},Fs={class:"alert alert-info mb-0"},Ls={class:"mb-0"},Ns={class:"text-muted"},Qs={class:"modal-footer"},Rs=O({__name:"ExerciseDetailModal",props:{exercise:{}},emits:["close","addRecord"],setup(u){const k=u,p=g(30),f=g("中等强度"),D=j(()=>{if(!k.exercise)return 0;const i=k.exercise.calories_per_minute*p.value,t=v(f.value);return Math.round(i*t)}),$=i=>{switch(i){case"初级":return"bg-success";case"中级":return"bg-warning";case"高级":return"bg-danger";default:return"bg-secondary"}},S=i=>{switch(i){case"初级":return"20-30";case"中级":return"30-45";case"高级":return"45-60";default:return"30"}},v=i=>({低强度:.8,中等强度:1,高强度:1.3,极限强度:1.6})[i]||1,r=i=>{var t,y;return i.includes("youtube.com/watch?v=")?`https://www.youtube.com/embed/${(t=i.split("v=")[1])==null?void 0:t.split("&")[0]}`:i.includes("youtu.be/")?`https://www.youtube.com/embed/${(y=i.split("youtu.be/")[1])==null?void 0:y.split("?")[0]}`:i};return(i,t)=>{var y;return o(),n("div",is,[s("div",os,[s("div",ds,[s("div",ns,[s("h5",cs,[t[5]||(t[5]=s("i",{class:"bi bi-trophy me-2"},null,-1)),b(" "+d(((y=u.exercise)==null?void 0:y.name)||"运动详情"),1)]),s("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=c=>i.$emit("close"))})]),s("div",rs,[u.exercise?(o(),n("div",us,[s("div",bs,[s("div",vs,[t[11]||(t[11]=s("div",{class:"card-header"},[s("h6",{class:"mb-0"},[s("i",{class:"bi bi-info-circle me-2"}),b("基本信息 ")])],-1)),s("div",ms,[s("table",gs,[s("tbody",null,[s("tr",null,[t[6]||(t[6]=s("td",null,[s("strong",null,"运动类别：")],-1)),s("td",null,[s("span",ps,d(u.exercise.category),1)])]),s("tr",null,[t[7]||(t[7]=s("td",null,[s("strong",null,"难度等级：")],-1)),s("td",null,[s("span",{class:x(["badge",$(u.exercise.difficulty_level)])},d(u.exercise.difficulty_level),3)])]),s("tr",null,[t[8]||(t[8]=s("td",null,[s("strong",null,"热量消耗：")],-1)),s("td",null,[s("span",ys,d(u.exercise.calories_per_minute)+" 千卡/分钟 ",1)])]),s("tr",null,[t[9]||(t[9]=s("td",null,[s("strong",null,"建议时长：")],-1)),s("td",null,d(S(u.exercise.difficulty_level))+" 分钟",1)])])]),s("div",fs,[t[10]||(t[10]=s("h6",null,"运动描述",-1)),s("p",xs,d(u.exercise.description),1)])])]),s("div",_s,[t[12]||(t[12]=s("div",{class:"card-header"},[s("h6",{class:"mb-0"},[s("i",{class:"bi bi-person-arms-up me-2"}),b("目标肌群 ")])],-1)),s("div",hs,[s("div",ks,[(o(!0),n(_,null,h(u.exercise.muscle_groups,c=>(o(),n("span",{key:c,class:"badge bg-secondary"},d(c),1))),128))])])]),u.exercise.equipment_needed.length>0?(o(),n("div",$s,[t[13]||(t[13]=s("div",{class:"card-header"},[s("h6",{class:"mb-0"},[s("i",{class:"bi bi-tools me-2"}),b("所需器材 ")])],-1)),s("div",ws,[s("div",Cs,[(o(!0),n(_,null,h(u.exercise.equipment_needed,c=>(o(),n("span",{key:c,class:"badge bg-warning text-dark"},d(c),1))),128))])])])):C("",!0)]),s("div",Es,[s("div",Ms,[t[15]||(t[15]=s("div",{class:"card-header"},[s("h6",{class:"mb-0"},[s("i",{class:"bi bi-play-circle me-2"}),b("运动教程 ")])],-1)),s("div",Ds,[u.exercise.tutorial_url?(o(),n("div",Ss,[s("iframe",{src:r(u.exercise.tutorial_url),frameborder:"0",allowfullscreen:""},null,8,Vs)])):(o(),n("div",As,[...t[14]||(t[14]=[s("i",{class:"bi bi-youtube fs-1 text-muted mb-3"},null,-1),s("p",{class:"text-muted"},"暂无视频教程",-1),s("small",{class:"text-muted"}," 建议在专业教练指导下进行训练，确保动作标准 ",-1)])]))])]),s("div",Is,[t[22]||(t[22]=s("div",{class:"card-header"},[s("h6",{class:"mb-0"},[s("i",{class:"bi bi-calculator me-2"}),b("卡路里计算器 ")])],-1)),s("div",js,[s("div",Bs,[t[18]||(t[18]=s("label",{class:"form-label"},"运动时长（分钟）",-1)),M(s("input",{type:"range",class:"form-range","onUpdate:modelValue":t[1]||(t[1]=c=>p.value=c),min:"5",max:"120",step:"5"},null,512),[[z,p.value,void 0,{number:!0}]]),s("div",Us,[t[16]||(t[16]=s("small",null,"5分钟",-1)),s("strong",null,d(p.value)+" 分钟",1),t[17]||(t[17]=s("small",null,"120分钟",-1))])]),s("div",qs,[t[20]||(t[20]=s("label",{class:"form-label"},"运动强度",-1)),M(s("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=c=>f.value=c)},[...t[19]||(t[19]=[s("option",{value:"低强度"},"低强度",-1),s("option",{value:"中等强度"},"中等强度",-1),s("option",{value:"高强度"},"高强度",-1),s("option",{value:"极限强度"},"极限强度",-1)])],512),[[B,f.value]])]),s("div",Fs,[t[21]||(t[21]=s("h6",{class:"alert-heading"},"预计消耗热量",-1)),s("h3",Ls,d(D.value)+" 千卡",1),s("small",Ns," 基础值 × 强度系数 ("+d(v(f.value))+") ",1)])])]),t[23]||(t[23]=T('<div class="card" data-v-3a71b84e><div class="card-header" data-v-3a71b84e><h6 class="mb-0" data-v-3a71b84e><i class="bi bi-shield-exclamation me-2" data-v-3a71b84e></i>安全提示 </h6></div><div class="card-body" data-v-3a71b84e><ul class="list-unstyled mb-0" data-v-3a71b84e><li class="mb-2" data-v-3a71b84e><i class="bi bi-check-circle text-success me-2" data-v-3a71b84e></i> 运动前进行充分热身，预防运动损伤 </li><li class="mb-2" data-v-3a71b84e><i class="bi bi-check-circle text-success me-2" data-v-3a71b84e></i> 保持正确的姿势和呼吸节奏 </li><li class="mb-2" data-v-3a71b84e><i class="bi bi-check-circle text-success me-2" data-v-3a71b84e></i> 循序渐进增加运动强度和时长 </li><li class="mb-2" data-v-3a71b84e><i class="bi bi-check-circle text-success me-2" data-v-3a71b84e></i> 如感不适立即停止运动并咨询医生 </li><li class="mb-0" data-v-3a71b84e><i class="bi bi-check-circle text-success me-2" data-v-3a71b84e></i> 运动后进行适当拉伸放松 </li></ul></div></div>',1))])])):C("",!0)]),s("div",Qs,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=c=>i.$emit("close"))}," 关闭 "),s("button",{type:"button",class:"btn btn-success",onClick:t[4]||(t[4]=c=>i.$emit("addRecord",u.exercise))},[...t[24]||(t[24]=[s("i",{class:"bi bi-plus-circle me-2"},null,-1),b(" 添加运动记录 ",-1)])])])])])])}}}),Ps=G(Rs,[["__scopeId","data-v-3a71b84e"]]),Ws={class:"exercise-library container py-4"},Os={class:"row mb-4"},Ts={class:"col-md-6 col-lg-3 mb-3"},zs={class:"card h-100 border-success"},Gs={class:"card-body text-center"},Hs={class:"col-md-6 col-lg-3 mb-3"},Js={class:"card h-100 border-info"},Ks={class:"card-body text-center"},Xs={class:"text-info"},Ys={class:"text-muted"},Zs={class:"col-md-6 col-lg-3 mb-3"},se={class:"card h-100 border-warning"},ee={class:"card-body text-center"},te={class:"text-warning"},le={class:"col-md-6 col-lg-3 mb-3"},ae={class:"card h-100 border-danger"},ie={class:"card-body text-center"},oe={class:"text-danger"},de={class:"card mb-4"},ne={class:"card-body"},ce={class:"row g-3"},re={class:"col-md-4"},ue={class:"col-md-3"},be=["value"],ve={class:"col-md-3"},me={class:"row"},ge={class:"col-12"},pe={class:"card"},ye={class:"card-header d-flex justify-content-between align-items-center"},fe={class:"mb-0"},xe={class:"d-flex align-items-center gap-3"},_e={class:"btn-group",role:"group"},he={class:"badge bg-secondary"},ke={class:"card-body p-0"},$e={key:0,class:"text-center py-5"},we={key:1,class:"p-3"},Ce={class:"row g-4"},Ee={class:"card h-100 exercise-card"},Me={class:"card-header d-flex justify-content-between align-items-center"},De={class:"card-title mb-0"},Se={class:"card-body"},Ve={class:"mb-2"},Ae={class:"badge bg-light text-dark me-1"},Ie={class:"badge bg-info text-white"},je={class:"card-text small text-muted"},Be={class:"mb-2"},Ue={class:"mt-1"},qe={key:0,class:"badge bg-secondary"},Fe={key:0,class:"mb-3"},Le={class:"mt-1"},Ne={class:"card-footer bg-transparent"},Qe={class:"btn-group w-100",role:"group"},Re=["onClick"],Pe=["onClick"],We={"aria-label":"运动列表分页",class:"mt-4"},Oe={class:"pagination justify-content-center"},Te=["disabled"],ze=["onClick"],Ge=["disabled"],He={key:2,class:"text-center py-5"},Je={class:"text-muted"},Ke={class:"text-muted"},Xe={class:"d-flex justify-content-center gap-2"},Ye=O({__name:"ExerciseLibraryView",setup(u){const k=g(!0),p=g([]),f=g(new Set),D=g([]),$=g({total_duration:0,total_sessions:0,total_calories:0}),S=g(0),v=g(!0),r=Q({search:"",category:"",difficulty:""}),i=Q({page:1,limit:12,total:0,pages:0}),t=g(!1),y=g(!1),c=g(null),U=g(null),A=j(()=>v.value?p.value.filter(a=>f.value.has(a.id)):p.value),H=j(()=>{const a=i.page,e=i.pages,l=2,m=[],w=[];for(let E=Math.max(2,a-l);E<=Math.min(e-1,a+l);E++)m.push(E);return a-l>2?w.push(1,"..."):w.push(1),w.push(...m),a+l<e-1?w.push("...",e):w.push(e),w.filter((E,ss,es)=>es.indexOf(E)===ss)}),V=async()=>{try{k.value=!0;const a={page:i.page,limit:100,...r.search&&{search:r.search},...r.category&&{category:r.category},...r.difficulty&&{difficulty_level:r.difficulty}},e=await P.getExercises(a);if(e.success){p.value=e.data.exercises,i.total=e.data.pagination.total,i.pages=e.data.pagination.pages;const l=[...new Set(p.value.map(m=>m.category))];D.value=l.sort()}}catch(a){console.error("加载运动列表失败:",a)}finally{k.value=!1}},q=async()=>{try{const a=await P.getExerciseLogs({limit:1e3});if(a.success){const e=new Set;a.data.logs.forEach(l=>{e.add(l.exercise_id)}),f.value=e}}catch(a){console.error("加载我的运动失败:",a)}},F=async()=>{try{const a=await W.getWeekStats();a.success&&($.value={total_duration:a.data.total_minutes||0,total_sessions:a.data.exercises||0,total_calories:Math.round(a.data.calories_burned||0)})}catch(a){console.error("加载本周统计失败:",a)}},L=async()=>{try{const a=await W.getStreakDays();a.success&&(S.value=a.data.streak_days)}catch(a){console.error("加载连续打卡天数失败:",a)}},J=()=>{i.page=1,V()},K=()=>{r.search="",r.category="",r.difficulty="",i.page=1,V()},I=a=>{a>=1&&a<=i.pages&&(i.page=a,V())},X=a=>{switch(a){case"初级":return"bg-success";case"中级":return"bg-warning";case"高级":return"bg-danger";default:return"bg-secondary"}},Y=a=>{U.value=a,y.value=!0},N=a=>{c.value=a,t.value=!0},Z=()=>{t.value=!1,c.value=null,F(),L(),q()};return ts(async()=>{await Promise.all([V(),q(),F(),L()])}),(a,e)=>(o(),n("div",Ws,[e[38]||(e[38]=T('<div class="row mb-4" data-v-712d7c0d><div class="col-12" data-v-712d7c0d><div class="card bg-primary text-white" data-v-712d7c0d><div class="card-body" data-v-712d7c0d><h1 class="mb-0" data-v-712d7c0d><i class="bi bi-trophy me-2" data-v-712d7c0d></i>运动库 </h1><p class="mb-0 mt-2 opacity-75" data-v-712d7c0d>探索各种运动项目，记录你的训练成果</p></div></div></div></div>',1)),s("div",Os,[s("div",Ts,[s("div",zs,[s("div",Gs,[e[11]||(e[11]=s("i",{class:"bi bi-plus-circle fs-1 text-success mb-2"},null,-1)),e[12]||(e[12]=s("h5",{class:"card-title"},"快速记录",-1)),s("button",{class:"btn btn-success",onClick:e[0]||(e[0]=l=>t.value=!0)}," 添加运动记录 ")])])]),s("div",Hs,[s("div",Js,[s("div",Ks,[e[13]||(e[13]=s("i",{class:"bi bi-calendar-week fs-1 text-info mb-2"},null,-1)),e[14]||(e[14]=s("h5",{class:"card-title"},"本周运动",-1)),s("h3",Xs,d($.value.total_duration)+"分钟",1),s("small",Ys,d($.value.total_sessions)+"次训练",1)])])]),s("div",Zs,[s("div",se,[s("div",ee,[e[15]||(e[15]=s("i",{class:"bi bi-fire fs-1 text-warning mb-2"},null,-1)),e[16]||(e[16]=s("h5",{class:"card-title"},"消耗卡路里",-1)),s("h3",te,d($.value.total_calories),1),e[17]||(e[17]=s("small",{class:"text-muted"},"千卡",-1))])])]),s("div",le,[s("div",ae,[s("div",ie,[e[18]||(e[18]=s("i",{class:"bi bi-graph-up fs-1 text-danger mb-2"},null,-1)),e[19]||(e[19]=s("h5",{class:"card-title"},"连续打卡",-1)),s("h3",oe,d(S.value)+"天",1),e[20]||(e[20]=s("small",{class:"text-muted"},"坚持就是胜利",-1))])])])]),s("div",de,[e[27]||(e[27]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-search me-2"}),b("搜索运动 ")])],-1)),s("div",ne,[s("form",{onSubmit:ls(J,["prevent"])},[s("div",ce,[s("div",re,[e[21]||(e[21]=s("label",{class:"form-label"},"关键词",-1)),M(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=l=>r.search=l),placeholder:"搜索运动名称、描述..."},null,512),[[z,r.search]])]),s("div",ue,[e[23]||(e[23]=s("label",{class:"form-label"},"类别",-1)),M(s("select",{class:"form-select","onUpdate:modelValue":e[2]||(e[2]=l=>r.category=l)},[e[22]||(e[22]=s("option",{value:""},"全部类别",-1)),(o(!0),n(_,null,h(D.value,l=>(o(),n("option",{key:l,value:l},d(l),9,be))),128))],512),[[B,r.category]])]),s("div",ve,[e[25]||(e[25]=s("label",{class:"form-label"},"难度",-1)),M(s("select",{class:"form-select","onUpdate:modelValue":e[3]||(e[3]=l=>r.difficulty=l)},[...e[24]||(e[24]=[s("option",{value:""},"全部难度",-1),s("option",{value:"初级"},"初级",-1),s("option",{value:"中级"},"中级",-1),s("option",{value:"高级"},"高级",-1)])],512),[[B,r.difficulty]])]),e[26]||(e[26]=s("div",{class:"col-md-2 d-flex align-items-end"},[s("button",{type:"submit",class:"btn btn-primary w-100"},[s("i",{class:"bi bi-search me-1"}),b("搜索 ")])],-1))])],32)])]),s("div",me,[s("div",ge,[s("div",pe,[s("div",ye,[s("h5",fe,[e[28]||(e[28]=s("i",{class:"bi bi-list-ul me-2"},null,-1)),b(" "+d(v.value?"我的运动记录":"全部运动项目"),1)]),s("div",xe,[s("div",_e,[s("button",{type:"button",class:x(["btn btn-sm",v.value?"btn-primary":"btn-outline-primary"]),onClick:e[4]||(e[4]=l=>v.value=!0)},[...e[29]||(e[29]=[s("i",{class:"bi bi-person-check me-1"},null,-1),b("我的运动 ",-1)])],2),s("button",{type:"button",class:x(["btn btn-sm",v.value?"btn-outline-primary":"btn-primary"]),onClick:e[5]||(e[5]=l=>v.value=!1)},[...e[30]||(e[30]=[s("i",{class:"bi bi-grid me-1"},null,-1),b("全部运动 ",-1)])],2)]),s("span",he,d(A.value.length)+" 个运动 ",1)])]),s("div",ke,[k.value?(o(),n("div",$e,[...e[31]||(e[31]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"加载中...")],-1),s("p",{class:"mt-2 text-muted"},"正在加载运动数据...",-1)])])):A.value.length>0?(o(),n("div",we,[s("div",Ce,[(o(!0),n(_,null,h(A.value,l=>(o(),n("div",{key:l.id,class:"col-md-6 col-lg-4"},[s("div",Ee,[s("div",Me,[s("h6",De,d(l.name),1),s("span",{class:x(["badge",X(l.difficulty_level)])},d(l.difficulty_level),3)]),s("div",Se,[s("div",Ve,[s("span",Ae,d(l.category),1),s("span",Ie,d(l.calories_per_minute)+" 千卡/分钟 ",1)]),s("p",je,d(l.description),1),s("div",Be,[e[32]||(e[32]=s("strong",{class:"text-muted"},"目标肌群：",-1)),s("div",Ue,[(o(!0),n(_,null,h(l.muscle_groups.slice(0,3),m=>(o(),n("span",{key:m,class:"badge bg-secondary me-1 mb-1"},d(m),1))),128)),l.muscle_groups.length>3?(o(),n("span",qe," +"+d(l.muscle_groups.length-3),1)):C("",!0)])]),l.equipment_needed.length>0?(o(),n("div",Fe,[e[33]||(e[33]=s("strong",{class:"text-muted"},"所需器材：",-1)),s("div",Le,[(o(!0),n(_,null,h(l.equipment_needed,m=>(o(),n("span",{key:m,class:"badge bg-warning text-dark me-1 mb-1"},d(m),1))),128))])])):C("",!0)]),s("div",Ne,[s("div",Qe,[s("button",{class:"btn btn-outline-primary btn-sm",onClick:m=>Y(l)},[...e[34]||(e[34]=[s("i",{class:"bi bi-eye me-1"},null,-1),b("详情 ",-1)])],8,Re),s("button",{class:"btn btn-success btn-sm",onClick:m=>N(l)},[...e[35]||(e[35]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),b("记录 ",-1)])],8,Pe)])])])]))),128))]),s("nav",We,[s("ul",Oe,[s("li",{class:x(["page-item",{disabled:i.page<=1}])},[s("button",{class:"page-link",onClick:e[6]||(e[6]=l=>I(i.page-1)),disabled:i.page<=1}," 上一页 ",8,Te)],2),(o(!0),n(_,null,h(H.value,l=>(o(),n("li",{key:l,class:x(["page-item",{active:l===i.page}])},[s("button",{class:"page-link",onClick:m=>I(l)},d(l),9,ze)],2))),128)),s("li",{class:x(["page-item",{disabled:i.page>=i.pages}])},[s("button",{class:"page-link",onClick:e[7]||(e[7]=l=>I(i.page+1)),disabled:i.page>=i.pages}," 下一页 ",8,Ge)],2)])])])):(o(),n("div",He,[e[37]||(e[37]=s("i",{class:"bi bi-search fs-1 text-muted mb-3"},null,-1)),s("h5",Je,d(v.value?"您还没有记录过运动":"没有找到相关运动"),1),s("p",Ke,d(v.value?'点击"全部运动"浏览运动库，添加您的第一个运动记录吧！':"尝试调整搜索条件或查看全部运动"),1),s("div",Xe,[v.value?(o(),n("button",{key:0,class:"btn btn-primary",onClick:e[8]||(e[8]=l=>v.value=!1)},[...e[36]||(e[36]=[s("i",{class:"bi bi-grid me-1"},null,-1),b("浏览全部运动 ",-1)])])):(o(),n("button",{key:1,class:"btn btn-outline-primary",onClick:K}," 重置搜索 "))])]))])])])]),t.value?(o(),R(as,{key:0,exercise:c.value,onClose:e[9]||(e[9]=l=>t.value=!1),onAdded:Z},null,8,["exercise"])):C("",!0),y.value?(o(),R(Ps,{key:1,exercise:U.value,onClose:e[10]||(e[10]=l=>y.value=!1),onAddRecord:N},null,8,["exercise"])):C("",!0)]))}}),et=G(Ye,[["__scopeId","data-v-712d7c0d"]]);export{et as default};
